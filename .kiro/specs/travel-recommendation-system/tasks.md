# 开发任务拆分

## 概述

本文档按功能模块垂直拆分开发任务，每个模块包含后端接口 + 管理端页面 + 用户端小程序的完整实现，确保每个模块都是独立可交付的。

## 技术栈

- **后端**: Java 17 + Spring Boot 3.2.12 + MyBatis-Plus 3.5.5 + MySQL 8.0 + Redis
- **管理端**: Vue 3 + Element Plus + Axios + Vite
- **用户端**: Uni-app + Vue.js 3 + Pinia

---

## 任务列表

### 模块零：项目初始化

- [x] 0. 项目基础设施搭建
  - [x] 0.1 创建后端 Spring Boot 项目
    - 配置 Maven 依赖（Web、MyBatis-Plus、MySQL、Redis、JWT、Swagger）
    - 配置多环境 application.yml
    - 创建统一响应封装 ApiResponse
    - 创建全局异常处理 GlobalExceptionHandler
    - 配置 Swagger 文档
  - [x] 0.2 执行数据库初始化
    - 执行建表脚本（13张表）
    - 插入基础数据（地区、分类、管理员）
    - 生成 MyBatis-Plus Entity 和 Mapper
  - [x] 0.3 创建管理端 Vue 项目
    - 配置 Element Plus、Vue Router、Pinia、Axios
    - 创建基础布局（侧边栏、顶栏）
    - 配置请求拦截器
  - [x] 0.4 创建小程序项目
    - 配置项目结构和全局样式
    - 封装请求工具
    - 配置 TabBar

- [ ] 1. 检查点 - 三端项目能正常运行

---

### 模块一：用户认证

- [-] 2. 用户认证模块
  - [x] 2.1 【后端】实现 JWT 工具类
    - Token 生成、解析、验证
    - _需求: 18.4_
  - [x] 2.2 【后端】实现 Token 认证拦截器
    - 区分用户端和管理端
    - _需求: 13.2, 18.4_
  - [x] 2.3 【后端】实现微信登录接口 POST /api/v1/auth/wx-login
    - 调用微信 API 换取 OpenID，自动注册/登录
    - _需求: 1.1, 1.2, 1.3_
  - [x] 2.4 【后端】实现用户信息接口 GET/PUT /api/v1/auth/user-info
    - _需求: 1.4, 1.5_
  - [x] 2.5 【后端】实现偏好标签接口 POST /api/v1/auth/preferences
    - _需求: 3.2_
  - [x] 2.6 【后端】实现管理员登录接口 POST /api/admin/v1/auth/login
    - BCrypt 密码验证
    - _需求: 13.1, 13.3_
  - [x] 2.7 【管理端】实现登录页面
    - _需求: 13.1_
  - [x] 2.8 【管理端】实现路由守卫
    - 未登录重定向到登录页
    - _需求: 13.2_
  - [x] 2.9 【小程序】实现微信一键登录
    - _需求: 1.1, 1.2, 1.3_
  - [x] 2.10 【小程序】实现登录状态管理
  - [ ]\* 2.11 编写登录幂等性属性测试
    - **Property 1: 登录幂等性**
    - **验证: 需求 1.2, 1.3**
  - [ ]\* 2.12 编写访问控制属性测试
    - **Property 25: 访问控制**
    - **验证: 需求 13.2, 18.4**

- [ ] 3. 检查点 - 三端登录流程正常

---

### 模块二：景点管理

- [-] 4. 景点模块
  - [x] 4.1 【后端】实现景点列表接口 GET /api/v1/spots
    - 支持地区、分类筛选，热度/评分/价格排序，分页
    - _需求: 4.1, 4.2, 4.3_
  - [x] 4.2 【后端】实现景点搜索接口 GET /api/v1/spots/search
    - 模糊搜索
    - _需求: 4.4, 4.5_
  - [x] 4.3 【后端】实现景点详情接口 GET /api/v1/spots/{id}
    - 包含图片、评论、收藏状态
    - _需求: 4.6_
  - [x] 4.4 【后端】实现筛选选项接口 GET /api/v1/spots/filters
  - [x] 4.5 【后端】实现管理端景点 CRUD 接口
    - POST/PUT/DELETE /api/admin/v1/spots
    - _需求: 14.1, 14.2, 14.3, 14.4_
  - [ ] 4.6 【后端】实现图片上传接口 POST /api/admin/v1/upload/image
  - [x] 4.7 【管理端】实现景点列表页面
    - 筛选、搜索、分页
    - _需求: 14.4_
  - [x] 4.8 【管理端】实现景点新增/编辑表单
    - 含地图选点、图片上传
    - _需求: 14.1, 14.2_
  - [x] 4.9 【管理端】实现景点发布/下架功能
    - _需求: 14.3_
  - [x] 4.10 【小程序】实现景点列表页面
    - 筛选、排序、下拉加载
    - _需求: 4.1, 4.2, 4.3_
  - [x] 4.11 【小程序】实现景点搜索页面
    - _需求: 4.4, 4.5_
  - [x] 4.12 【小程序】实现景点详情页面
    - _需求: 4.6_
  - [x] 4.13 【小程序】实现地图导航功能
    - _需求: 4.7, 4.8_
  - [ ]\* 4.14 编写景点筛选排序属性测试
    - **Property 7, 8: 景点筛选/排序正确性**
    - **验证: 需求 4.1, 4.2**
  - [ ]\* 4.15 编写发布状态过滤属性测试
    - **Property 12: 发布状态过滤**
    - **验证: 需求 14.3**

- [ ] 5. 检查点 - 景点增删改查和浏览搜索正常

---

### 模块三：攻略管理

- [x] 6. 攻略模块
  - [x] 6.1 【后端】实现攻略列表接口 GET /api/v1/guides
    - 支持分类筛选、时间排序、分页
    - _需求: 5.1, 5.2_
  - [x] 6.2 【后端】实现攻略详情接口 GET /api/v1/guides/{id}
    - 含关联景点
    - _需求: 5.3_
  - [x] 6.3 【后端】实现攻略分类接口 GET /api/v1/guides/categories
  - [x] 6.4 【后端】实现管理端攻略 CRUD 接口
    - _需求: 15.1, 15.2, 15.3_
  - [x] 6.5 【管理端】实现攻略列表页面
  - [x] 6.6 【管理端】实现攻略编辑表单（富文本编辑器）
    - _需求: 15.1, 15.2_
  - [x] 6.7 【管理端】实现攻略关联景点选择
  - [x] 6.8 【小程序】实现攻略列表页面
    - _需求: 5.1, 5.2_
  - [x] 6.9 【小程序】实现攻略详情页面（富文本渲染）
    - _需求: 5.3_
  - [x] 6.10 【小程序】实现关联景点展示和跳转
  - [ ]\* 6.11 编写攻略排序属性测试
    - **Property 11: 攻略排序正确性**
    - **验证: 需求 5.1**

- [ ] 7. 检查点 - 攻略管理和浏览正常

---

### 模块四：评分与收藏

- [x] 8. 评分收藏模块
  - [x] 8.1 【后端】实现评分提交接口 POST /api/v1/ratings
    - 新增或更新评分
    - _需求: 6.1, 6.2, 6.3_
  - [x] 8.2 【后端】实现用户评分查询接口 GET /api/v1/ratings/spot/{id}
  - [x] 8.3 【后端】实现评论列表接口 GET /api/v1/ratings/spot/{id}/comments
  - [x] 8.4 【后端】实现评分后更新景点平均分
    - _需求: 6.4_
  - [x] 8.5 【后端】实现收藏接口 POST/DELETE /api/v1/favorites
    - _需求: 7.1, 7.2_
  - [x] 8.6 【后端】实现收藏列表接口 GET /api/v1/favorites
    - _需求: 7.3_
  - [x] 8.7 【后端】实现收藏状态检查接口 GET /api/v1/favorites/check/{id}
    - _需求: 7.4_
  - [x] 8.8 【小程序】在景点详情页实现评分提交
    - _需求: 6.1, 6.2, 6.3_
  - [x] 8.9 【小程序】在景点详情页实现评论展示
  - [x] 8.10 【小程序】在景点详情页实现收藏按钮
    - _需求: 7.1, 7.2, 7.4_
  - [x] 8.11 【小程序】实现收藏列表页面
    - _需求: 7.3_
  - [ ]\* 8.12 编写评分持久化属性测试
    - **Property 13, 14: 评分持久化/更新幂等性**
    - **验证: 需求 6.1, 6.2**
  - [ ]\* 8.13 编写收藏操作往返属性测试
    - **Property 16: 收藏操作往返**
    - **验证: 需求 7.1, 7.2, 7.3**

- [ ] 9. 检查点 - 评分和收藏功能正常

---

### 模块五：订单管理

- [x] 10. 订单模块
  - [x] 10.1 【后端】实现订单创建接口 POST /api/v1/orders
    - 含幂等控制
    - _需求: 8.1, 18.6_
  - [x] 10.2 【后端】实现订单列表接口 GET /api/v1/orders
    - 支持状态筛选、分页
    - _需求: 8.2, 8.3_
  - [x] 10.3 【后端】实现订单详情接口 GET /api/v1/orders/{id}
    - _需求: 8.4_
  - [x] 10.4 【后端】实现模拟支付接口 POST /api/v1/orders/{id}/pay
    - 含幂等控制
    - _需求: 9.1, 9.2, 9.3_
  - [x] 10.5 【后端】实现订单取消接口 POST /api/v1/orders/{id}/cancel
    - 含状态校验和幂等
    - _需求: 10.1, 10.2, 10.3, 10.4_
  - [x] 10.6 【后端】实现管理端订单列表接口 GET /api/admin/v1/orders
    - 支持时间、状态筛选
    - _需求: 16.1, 16.3_
  - [x] 10.7 【后端】实现管理端订单详情接口 GET /api/admin/v1/orders/{id}
    - _需求: 16.2_
  - [x] 10.8 【后端】实现管理端订单完成接口 POST /api/admin/v1/orders/{id}/complete
    - _需求: 11.1, 11.3_
  - [x] 10.8.5 【后端】实现管理端订单退款接口 POST /api/admin/v1/orders/{id}/refund
    - _需求: 11.4_
  - [x] 10.9 【管理端】实现订单列表页面
    - 筛选、分页
    - _需求: 16.1, 16.3_
  - [x] 10.10 【管理端】实现订单详情弹窗
    - _需求: 16.2_
  - [x] 10.11 【管理端】实现订单完成操作
    - _需求: 11.1_
  - [x] 10.11.5 【管理端】实现订单退款操作
    - _需求: 11.4_
  - [x] 10.12 【小程序】实现订单创建页面（下单表单）
    - _需求: 8.1_
  - [x] 10.13 【小程序】实现订单列表页面
    - 状态筛选、下拉加载
    - _需求: 8.2, 8.3_
  - [x] 10.14 【小程序】实现订单详情页面
    - _需求: 8.4_
  - [x] 10.15 【小程序】实现模拟支付流程
    - _需求: 9.1, 9.2_
  - [x] 10.16 【小程序】实现订单取消功能
    - _需求: 10.1, 10.2, 10.5_
  - [ ]\* 10.17 编写订单状态机属性测试
    - **Property 17, 19, 22: 订单创建/支付/状态机约束**
    - **验证: 需求 8.1, 9.2, 10.1, 10.3, 11.3**
  - [ ]\* 10.18 编写订单幂等性属性测试
    - **Property 20, 23, 31: 支付/取消/创建幂等性**
    - **验证: 需求 9.3, 10.4, 18.6**

- [ ] 11. 检查点 - 订单全流程（创建→支付→完成/取消）正常

---

### 模块六：个性化推荐

- [x] 12. 推荐模块
  - [x] 12.1 【后端】实现物品相似度矩阵计算
    - ItemCF 余弦相似度，存入 Redis
    - _需求: 3.1_
  - [x] 12.2 【后端】实现个性化推荐接口 GET /api/v1/recommendations
    - 基于用户评分和相似度矩阵
    - _需求: 3.1, 3.3_
  - [x] 12.3 【后端】实现推荐过滤逻辑
    - 过滤已评分、已收藏、已下单（不含已取消）
    - _需求: 3.3, 3.4_
  - [x] 12.4 【后端】实现冷启动策略
    - 评分不足时返回热门，引导设置偏好
    - _需求: 3.2_
  - [x] 12.5 【后端】实现推荐刷新接口 POST /api/v1/recommendations/refresh
    - _需求: 3.5_
  - [x] 12.6 【后端】实现热门推荐接口 GET /api/v1/home/hot
    - _需求: 2.3_
  - [x] 12.7 【后端】配置定时任务更新相似度矩阵
  - [x] 12.8 【小程序】在首页实现个性化推荐区域
    - _需求: 3.1, 3.5_
  - [x] 12.9 【小程序】在首页实现热门推荐区域
    - _需求: 2.3, 2.4_
  - [x] 12.10 【小程序】实现推荐刷新交互
    - _需求: 3.5_
  - [x] 12.11 【小程序】实现偏好标签引导弹窗
    - _需求: 3.2_
  - [ ]\* 12.12 编写推荐过滤属性测试
    - **Property 4: 推荐过滤规则**
    - **验证: 需求 3.3, 3.4**
  - [ ]\* 12.13 编写冷启动策略属性测试
    - **Property 5: 冷启动策略**
    - **验证: 需求 3.2**
  - [ ]\* 12.14 编写个性化差异性属性测试
    - **Property 6: 个性化推荐差异性**
    - **验证: 需求 3.6**

- [ ] 13. 检查点 - 推荐功能正常（个性化/冷启动/热门）

---

### 模块七：首页与轮播图

- [x] 14. 首页轮播图模块
  - [x] 14.1 【后端】实现轮播图列表接口 GET /api/v1/home/banners
    - _需求: 2.1_
  - [x] 14.2 【后端】实现管理端轮播图 CRUD 接口
  - [x] 14.3 【管理端】实现轮播图列表页面
  - [x] 14.4 【管理端】实现轮播图新增/编辑/删除
  - [x] 14.5 【管理端】实现轮播图排序功能
  - [x] 14.6 【小程序】实现首页轮播图组件
    - _需求: 2.1, 2.2_
  - [x] 14.7 【小程序】实现首页下拉刷新

- [ ] 15. 检查点 - 首页和轮播图正常

---

### 模块八：个人中心

- [x] 16. 个人中心模块
  - [x] 16.1 【小程序】实现个人中心页面
    - 显示昵称、头像、偏好标签
    - _需求: 12.1_
  - [x] 16.2 【小程序】实现昵称修改功能
    - _需求: 1.5_
  - [x] 16.3 【小程序】实现订单入口
    - _需求: 12.2_
  - [x] 16.4 【小程序】实现收藏入口
    - _需求: 12.3_
  - [x] 16.5 【小程序】实现客服入口
    - _需求: 12.4_
  - [ ]\* 16.6 编写用户信息更新属性测试
    - **Property 2: 用户信息更新往返**
    - **验证: 需求 1.5**

- [ ] 17. 检查点 - 个人中心功能正常

---

### 模块九：用户管理（管理端）

- [x] 18. 用户管理模块
  - [x] 18.1 【后端】实现用户列表接口 GET /api/admin/v1/users
    - 脱敏处理，不返回 OpenID
    - _需求: 17.1, 17.2, 17.3_
  - [x] 18.2 【后端】实现用户详情接口 GET /api/admin/v1/users/{id}
  - [x] 18.3 【管理端】实现用户列表页面
    - _需求: 17.1, 17.3_
  - [x] 18.4 【管理端】实现用户详情弹窗
  - [ ]\* 18.5 编写用户信息脱敏属性测试
    - **Property 30: 用户信息脱敏**
    - **验证: 需求 17.2**

- [ ] 19. 检查点 - 用户管理功能正常

---

### 模块十：仪表板统计（管理端）

- [x] 20. 仪表板模块
  - [x] 20.1 【后端】实现概览数据接口 GET /api/admin/v1/dashboard/overview
    - _需求: 19.1, 19.2_
  - [x] 20.2 【后端】实现订单趋势接口 GET /api/admin/v1/dashboard/order-trend
    - _需求: 19.3_
  - [x] 20.3 【后端】实现热门景点接口 GET /api/admin/v1/dashboard/hot-spots
    - _需求: 19.4_
  - [x] 20.4 【管理端】实现仪表板页面
    - 数据卡片、趋势图表、排行列表
    - _需求: 19.1, 19.2, 19.3, 19.4_

- [ ] 21. 检查点 - 仪表板统计正常

---

### 模块十一：性能优化与收尾

- [ ] 22. 性能优化
  - [ ] 22.1 添加 Redis 缓存（热门景点、轮播图、推荐结果）
    - _需求: 18.1, 18.2, 18.3_
  - [ ] 22.2 优化数据库查询和索引
  - [ ] 22.3 优化小程序首屏加载

- [ ] 23. 集成测试
  - [ ] 23.1 编写后端集成测试
  - [ ] 23.2 进行前后端联调测试
  - [ ] 23.3 进行小程序真机测试

- [ ] 24. 最终检查点
  - 确保所有功能正常，性能达标，准备部署

---

## 任务统计

| 模块                 | 任务数         | 属性测试数       |
| -------------------- | -------------- | ---------------- |
| 模块零：项目初始化   | 1              | 0                |
| 模块一：用户认证     | 1              | 2                |
| 模块二：景点管理     | 1              | 2                |
| 模块三：攻略管理     | 1              | 1                |
| 模块四：评分与收藏   | 1              | 2                |
| 模块五：订单管理     | 1              | 2                |
| 模块六：个性化推荐   | 1              | 3                |
| 模块七：首页与轮播图 | 1              | 0                |
| 模块八：个人中心     | 1              | 1                |
| 模块九：用户管理     | 1              | 1                |
| 模块十：仪表板统计   | 1              | 0                |
| 模块十一：性能优化   | 2              | 0                |
| **合计**             | **13个主模块** | **14个属性测试** |

## 开发顺序建议

```
模块零 → 模块一 → 模块二 → 模块三 → 模块四 → 模块五 → 模块六 → 模块七 → 模块八 → 模块九 → 模块十 → 模块十一
```

每个模块完成后都有检查点验证，确保功能完整可用后再进入下一个模块。

## 注意事项

1. 标记 `*` 的子任务为可选的属性测试任务
2. 每个模块按【后端】→【管理端】→【小程序】顺序开发
3. 检查点用于验证模块功能完整性
4. 建议按顺序开发，因为后续模块可能依赖前面模块
